<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Today's Readings</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root {
        --bg: #fbfbfb;
        --card: #ffffff;
        --text: #111;
        --muted: #6b7280;
        --border: #e5e7eb;
        --shadow: 0 1px 2px rgba(0,0,0,0.04);
      }

      body {
        margin: 18px;
        max-width: 900px;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        color: var(--text);
        background: var(--bg);
      }

      a { color: inherit; text-decoration: none; }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: baseline;
        gap: 12px;
        margin-bottom: 6px;
      }

      h1 {
        margin: 0;
        font-size: 1.4rem;
        letter-spacing: -0.01em;
      }

      .sub {
        margin: 0 0 14px 0;
        color: var(--muted);
        font-size: 0.98rem;
      }

      .btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 10px 12px;
        border: 1px solid var(--border);
        border-radius: 12px;
        background: var(--card);
        box-shadow: var(--shadow);
        font-weight: 650;
      }

      .card {
        border: 1px solid var(--border);
        border-radius: 14px;
        background: var(--card);
        box-shadow: var(--shadow);
        padding: 16px;
        margin: 14px 0;
      }

      .ref {
        font-weight: 800;
        font-size: 1.05rem;
        margin-bottom: 10px;
      }

      pre {
        margin: 0;
        white-space: pre-wrap;
        word-wrap: break-word;
        line-height: 1.6;
        font-size: 1.02rem;
        color: #1f2937;
      }

      .daypicker {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        align-items: center;
        margin: 18px 0 8px 0;
      }

      .daypicker .btn {
        flex: 1;
        justify-content: center;
      }

      .daypicker .btn.today {
        flex: 0.9;
        font-weight: 800;
      }

      .footer { margin-top: 6px; }
    </style>
  </head>

  <body>
    <div class="header">
      <h1>Today‚Äôs Readings</h1>
      <a class="btn" href="{{ url_for('calendar_view') }}">üìÖ Calendar</a>
    </div>

    <p class="sub">{{ day.strftime('%A, %B %d, %Y') }}</p>

    {% for p in passages %}
      <div class="card">
        <div class="ref">{{ p.reference }}</div>
        <pre>{{ p.text }}</pre>
      </div>
    {% endfor %}

    <!-- Date picker moved to bottom -->
    <div class="daypicker" aria-label="Day navigation">
      <a class="btn" href="{{ url_for('day_view', day=prev_day.isoformat()) }}">‚Üê {{ prev_day.strftime('%m-%d') }}</a>
      <a class="btn today" href="{{ url_for('day_view', day=today.isoformat()) }}">Today</a>
      <a class="btn" href="{{ url_for('day_view', day=next_day.isoformat()) }}">{{ prev_day.strftime('%m-%d') }} ‚Üí</a>
    </div>


    <script>
      // Simple swipe navigation (mobile-friendly).
      // - Swipe left => next day
      // - Swipe right => previous day
      (function () {
        const prevUrl = "{{ url_for('day_view', day=prev_day.isoformat()) }}";
        const nextUrl = "{{ url_for('day_view', day=next_day.isoformat()) }}";

        let startX = null;
        let startY = null;

        function onTouchStart(e) {
          const t = e.touches[0];
          startX = t.clientX;
          startY = t.clientY;
        }

        function onTouchEnd(e) {
          if (startX === null || startY === null) return;

          const t = e.changedTouches[0];
          const dx = t.clientX - startX;
          const dy = t.clientY - startY;

          // Only treat mostly-horizontal gestures as swipes
          if (Math.abs(dx) > 60 && Math.abs(dx) > Math.abs(dy) * 1.5) {
            window.location.href = (dx < 0) ? nextUrl : prevUrl;
          }

          startX = null;
          startY = null;
        }

        document.addEventListener("touchstart", onTouchStart, { passive: true });
        document.addEventListener("touchend", onTouchEnd, { passive: true });
      })();
    </script>
  </body>
</html>
