{% extends "base.html" %}

{% block title %}Calendar{% endblock %}

{% block head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='calendar.css') }}" />
{% endblock %}

{% block header_subtitle %}
  <span class="subtitle">{{ current.strftime('%B %Y') }}</span>
{% endblock %}

{% block header_actions %}
  <a class="btn icon-btn" href="{{ url_for('calendar_view', ym=prev_month.strftime('%Y-%m')) }}" aria-label="Previous month">â†</a>
  <a class="btn icon-btn" href="{{ url_for('calendar_view', ym=next_month.strftime('%Y-%m')) }}" aria-label="Next month">â†’</a>
  <a class="btn icon-btn" href="{{ url_for('root') }}" aria-label="Todayâ€™s readings">ğŸ“–</a>
{% endblock %}

{% block content %}
  <div class="legend muted">
    <span class="pill">Tap a day to open reading</span>
    <span class="pill">Outlined = today</span>
  </div>

  <table aria-label="Calendar">
    <thead>
      <tr>
        <th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th>
      </tr>
    </thead>
    <tbody>
      {% for week in weeks %}
        <tr>
          {% for d in week %}
            {% set is_other = (d.month != current.month) %}
            {% set iso = d.isoformat() %}
            {% set is_today = (d == today) %}
            {% set in_bounds = (d >= min_day and d <= max_day) %}

            <td class="
                  {% if is_other %}other{% endif %}
                  {% if is_today %}today{% endif %}
                  {% if not in_bounds %}disabled{% else %}clickable{% endif %}
                ">
              {% if in_bounds %}
                <a class="cell" href="{{ url_for('day_view', day=iso) }}" aria-label="Open {{ iso }}">
                  <span class="daynum">{{ d.day }}</span>
                </a>
              {% else %}
                <span class="cell" aria-disabled="true">
                  <span class="daynum">{{ d.day }}</span>
                </span>
              {% endif %}
            </td>
          {% endfor %}
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <p class="muted" style="margin-top:14px;">
    Range limited to {{ min_day.isoformat() }} through {{ max_day.isoformat() }} while developing.
  </p>
{% endblock %}
